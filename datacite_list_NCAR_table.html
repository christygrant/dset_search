<!DOCTYPE html>
<html>
<head>
  <title>Datacite NCAR query</title>
  
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>
  
  <!-- Latest compiled and minified CSS -->
  <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">

  <!-- Latest compiled JavaScript -->
  <script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
  
  <!-- DataTable plugin for jQuery -->
  <script type="text/javascript" language="javascript" src="https://cdn.datatables.net/1.10.10/js/jquery.dataTables.js"></script>
 <!-- <script type="text/javascript" src="https://cdn.datatables.net/1.10.10/js/dataTables.filter.html.js"></script> -->

  

</head>
<body>

<div class="container"> 

<h1>NCAR Datacite Data Assets</h1>
<h3>Alpha version</h3>
  
   <div class="panel panel-default">Please <a href='https://jira.ucar.edu/secure/RapidBoard.jspa?rapidView=52&projectKey=DSET&view=planning.nodetail&quickFilter=118'>provide feedback using Jira</a>. 
  </div>
  

<!--
Query: https://search.datacite.org/api?q=*&fq=prefix:10.5065<br>
Query: https://search.datacite.org/api?q=*&fq=prefix:10.5065&wt=json&indent=true&fl=doi,title,description,publicationYear,contributor&rows=3000 <br>
-->	

    <div id="numFound">
	Number of assets found: 
	</div>
 
   <br>
	<table id="example" class="table table-bordered table-hover table-condensed" > 
	 <thead>
            <tr>
                <th>Title</th>
                <th>DOI</th>              
                <th>Description</th>
                <th>Contributor</th>
            </tr>
        </thead>
           
	</table>
  
</div>  
  
<script>



$(document).ready(function() {
    $.ajax({
        url: "https://search.datacite.org/api?q=*&fq=prefix:10.5065&wt=json&indent=true&fl=doi,title,description,publicationYear,contributor&rows=3000",
        type: "get",
        dataType: "json"
    }).then(function(data) {
    	var numFound = data.response.numFound;
        $('#numFound').append(numFound);
       
      // $('#title').append(data.response.docs[1].title);
     //  $('#doi').append(JSON.stringify(data.response.docs, null, 3));
      // $('#doi').append(JSON.stringify(data));
      
      	var doclist = data.response.docs;
      	//console.log(JSON.stringify(doclist));
      		
      		
         $('#example').DataTable({
            serverSide: false,
            paging: false,
            searching: true,
         	data : doclist,
         	columns : [
         	  { data: "title",
         	    defaultContent: "<i>Not set</i>",
         	    width: "20%",
         	    sortable: true, 
         	    searchable: true},
         	  { data: "doi", sortable: true, searchable: true},         	  
         	  { data: "description",
         	    defaultContent: "<i>Not set</i>",
         	    sortable: true, 
         	    searchable: true},
         	  { data: "contributor",
         	    defaultContent: "<i>Not set</i>"}
         	],
         	columnDefs : [
         	 { type: "string", targets: [0,2,3]},
         	{
         	   targets: 1,
         	   render: function(data, type, row) {
         	      return '<a href=http://dx.doi.org/' + data + '>' + data + '</a>';
         		}
         	}
         	
         	]
         
         });
      
    });
});
</script>

</body>
</html>
