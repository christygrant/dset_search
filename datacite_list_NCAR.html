<!DOCTYPE html>
<html>
<head>
  <title>Datacite NCAR query</title>
  
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>
  
  <!-- Latest compiled and minified CSS -->
  <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">

  <!-- Latest compiled JavaScript -->
  <script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>

</head>
<body>

<div class="container"> 

<h1>NCAR Datacite Data Assets</h1>
 <!-- Query: https://search.datacite.org/api?q=*&fq=prefix:10.5065<br>
  Query: https://search.datacite.org/api?q=*&fq=prefix:10.5065&wt=json&indent=true&fl=doi,title,created,updated,title,description,publicationYear,contributor&rows=3000 <br>
  -->

	<div>Search using Ctrl-F or Cmd-F</div>
	<br>
	<div id="numFound">
	  Number found: 
	</div>
	<br>
 
    <!-- Populated by jQuery loop -->
    <div id="display">
	 
	</div> 
  
</div>  <!-- container -->
  
<script>


$(document).ready(function() {
    $.ajax({
        url: "https://search.datacite.org/api?q=*&fq=prefix:10.5065&wt=json&indent=true&fl=doi,title,description,publicationYear,contributor&rows=1000",
        type: "get",
        dataType: "json"
    }).then(function(data) {
    	var numFound = data.response.numFound;
        $('#numFound').append(numFound);
       
      // $('#title').append(data.response.docs[1].title);
     //  $('#doi').append(JSON.stringify(data.response.docs, null, 3));
      // $('#doi').append(JSON.stringify(data));
      
      	var doclist = data.response.docs;
      	console.log(JSON.stringify(doclist));   
      
       		
      		$.each(doclist, function (i) {
      			var title = doclist[i].title;
      			var doi = doclist[i].doi;
      			var doi_link = '<a href=http://dx.doi.org/' + doi + '>' + doi + '</a>';
      			var description = doclist[i].description;
      			var contributor = doclist[i].contributor;
      		   // console.log("title field: " + title);
      		   // console.log("doi field: " + doi);
      		   // console.log("description field: " + description);
      		   console.log("contributor field: " + contributor);
      		  
      		    // This sets up the display of the page (template)
      		   // $('#display').append(doi_link + "<br><div>" + title + "</div><br><div>" + description + "</div><br>");
      		    
      		    $('#display').append("<div><b>" + title + "</b></div>");
      		    $('#display').append("<div>" + doi_link + "</div>");
      		    $('#display').append("<div><h5>Description</h5>" + description + "</div>");
      		    $('#display').append("<div><h5>Contributors</h5>" + contributor + "</div>");
      		    $('#display').append("<hr>");
      		});     		
    
    });
});
</script>

</body>
</html>
